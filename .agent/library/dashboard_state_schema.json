{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Dashboard State Schema",
  "description": "Defines the visual state and layout of the production dashboard canvas",
  "type": "object",
  "properties": {
    "dashboard_id": {
      "type": "string",
      "description": "Unique dashboard identifier"
    },
    "project_id": {
      "type": "string",
      "description": "Associated project identifier"
    },
    "last_updated": {
      "type": "string",
      "format": "date-time",
      "description": "Last time dashboard was updated"
    },
    "canvas_settings": {
      "type": "object",
      "description": "Canvas display settings",
      "properties": {
        "zoom_level": {
          "type": "number",
          "description": "Current zoom level (1.0 = 100%)",
          "minimum": 0.1,
          "maximum": 5.0
        },
        "pan_x": {
          "type": "number",
          "description": "Horizontal pan offset in pixels"
        },
        "pan_y": {
          "type": "number",
          "description": "Vertical pan offset in pixels"
        },
        "active_filters": {
          "type": "object",
          "properties": {
            "status": {
              "type": "array",
              "items": {
                "type": "string",
                "enum": ["planning", "in_progress", "review", "complete", "locked"]
              }
            },
            "phase": {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            "model": {
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          }
        }
      }
    },
    "nodes": {
      "type": "array",
      "description": "Visual representation of shots and assets as nodes",
      "items": {
        "type": "object",
        "properties": {
          "node_id": {
            "type": "string",
            "description": "Unique node identifier (matches shot_id or asset_id)"
          },
          "node_type": {
            "type": "string",
            "enum": ["shot", "character_sheet", "hero_frame", "video_clip", "audio_track", "vfx_element"],
            "description": "Type of node"
          },
          "position": {
            "type": "object",
            "properties": {
              "x": {
                "type": "number",
                "description": "X coordinate on canvas"
              },
              "y": {
                "type": "number",
                "description": "Y coordinate on canvas"
              }
            },
            "required": ["x", "y"]
          },
          "swim_lane": {
            "type": "string",
            "enum": [
              "pre_production",
              "hero_frame_generation",
              "upscaling",
              "character_lock",
              "video_generation",
              "audio_design",
              "vfx_compositing",
              "post_production",
              "delivery"
            ],
            "description": "Which workflow phase swim lane this node belongs to"
          },
          "visual_state": {
            "type": "object",
            "properties": {
              "color": {
                "type": "string",
                "description": "Node color (hex code or named color)"
              },
              "border_style": {
                "type": "string",
                "enum": ["solid", "dashed", "bold"],
                "description": "Border style (bold = critical path)"
              },
              "badge": {
                "type": "string",
                "enum": ["pass", "warning", "fail", "locked"],
                "description": "Quality badge displayed on node"
              },
              "thumbnail_url": {
                "type": "string",
                "description": "URL or path to thumbnail image"
              }
            }
          },
          "expanded": {
            "type": "boolean",
            "description": "Whether node detail panel is currently expanded"
          }
        },
        "required": ["node_id", "node_type", "position", "swim_lane"]
      }
    },
    "edges": {
      "type": "array",
      "description": "Connections between nodes (dependencies)",
      "items": {
        "type": "object",
        "properties": {
          "edge_id": {
            "type": "string",
            "description": "Unique edge identifier"
          },
          "source_node_id": {
            "type": "string",
            "description": "ID of source node"
          },
          "target_node_id": {
            "type": "string",
            "description": "ID of target node"
          },
          "edge_type": {
            "type": "string",
            "enum": ["direct", "reference", "critical_path"],
            "description": "Type of dependency"
          },
          "visual_style": {
            "type": "object",
            "properties": {
              "line_style": {
                "type": "string",
                "enum": ["solid", "dashed", "thick"],
                "description": "Line style"
              },
              "color": {
                "type": "string",
                "enum": ["green", "yellow", "red"],
                "description": "Edge color (green=satisfied, yellow=in progress, red=blocked)"
              }
            }
          }
        },
        "required": ["edge_id", "source_node_id", "target_node_id", "edge_type"]
      }
    },
    "critical_path": {
      "type": "array",
      "description": "Array of node IDs on the critical path (blocking next phase)",
      "items": {
        "type": "string"
      }
    },
    "alerts": {
      "type": "array",
      "description": "Active alerts displayed on dashboard",
      "items": {
        "type": "object",
        "properties": {
          "alert_id": {
            "type": "string",
            "description": "Unique alert identifier"
          },
          "type": {
            "type": "string",
            "enum": ["cost_warning", "cost_exceeded", "shot_blocked", "quality_issue"],
            "description": "Type of alert"
          },
          "severity": {
            "type": "string",
            "enum": ["info", "warning", "critical"],
            "description": "Alert severity level"
          },
          "message": {
            "type": "string",
            "description": "Alert message text"
          },
          "related_node_id": {
            "type": "string",
            "description": "Node ID this alert relates to (if applicable)"
          }
        },
        "required": ["alert_id", "type", "severity", "message"]
      }
    },
    "status_summary": {
      "type": "object",
      "description": "Summary statistics displayed in header panel",
      "properties": {
        "total_shots": {
          "type": "integer",
          "minimum": 0
        },
        "complete_shots": {
          "type": "integer",
          "minimum": 0
        },
        "in_progress_shots": {
          "type": "integer",
          "minimum": 0
        },
        "pending_shots": {
          "type": "integer",
          "minimum": 0
        },
        "total_cost": {
          "type": "number",
          "minimum": 0
        },
        "budget": {
          "type": "number",
          "minimum": 0
        },
        "remaining_budget": {
          "type": "number"
        },
        "current_phase": {
          "type": "string",
          "description": "Most common workflow phase across all shots"
        }
      }
    }
  },
  "required": ["dashboard_id", "project_id", "last_updated", "nodes", "edges", "status_summary"]
}
